# -*- coding: utf-8 -*-
"""
Created on Tue Feb 26 10:46:34 2019

@author: thuzhang
"""

import time
import datetime
import json
import icalendar
import pytz
# Login learn.tsinghua.edu.cn and get json from the following web 
# http://zhjw.cic.tsinghua.edu.cn/jxmh_out.do?m=bks_jxrl_all&p_start_date=20190101&p_end_date=20190706&jsoncallback=%20
strin = '''
[{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-02-25","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-02-25","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-02-25","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-02-26","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-02-27","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-02-27","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-02-28","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-04","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-03-04","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-03-04","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-05","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-06","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-03-06","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-03-07","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-11","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-03-11","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-03-11","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-12","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-13","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-03-13","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-03-14","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-18","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-03-18","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-03-18","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-19","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-20","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-03-20","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-03-21","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-25","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-03-25","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-03-25","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-26","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-03-27","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-03-27","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-03-28","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-01","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-04-01","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-04-01","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-02","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-03","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-04-03","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-04-04","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-08","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-04-08","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-04-08","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-09","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-10","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-04-10","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-04-11","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-15","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-04-15","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-04-15","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-16","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-17","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-04-17","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-04-18","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-22","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-04-22","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-04-22","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-23","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-24","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-04-24","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-04-25","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-29","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-04-29","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-04-29","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-04-30","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-01","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-05-01","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-05-02","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-06","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-05-06","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-05-06","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-07","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-08","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-05-08","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-05-09","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-13","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-05-13","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-05-13","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-14","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-15","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-05-15","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-05-16","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-20","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-05-20","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-05-20","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-21","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-22","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-05-22","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-05-23","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-27","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-05-27","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-05-27","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-28","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-05-29","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-05-29","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-05-30","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-06-03","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-06-03","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-06-03","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-06-04","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-06-05","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-06-05","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-06-06","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-06-10","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A010","fl":"上课","grrlID":0,"jssj":"16:55","kssj":"15:20","nq":"2019-06-10","nr":"计算能源经济学","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A116","fl":"上课","grrlID":0,"jssj":"21:45","kssj":"19:20","nq":"2019-06-10","nr":"多媒体设计与制作","sfSjtz":"","skjc":"","sm":""},{"dd":"射击馆(维学馆D)","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-06-11","nr":"射击","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A201","fl":"上课","grrlID":0,"jssj":"15:05","kssj":"13:30","nq":"2019-06-12","nr":"德语(第二外国语)(1)","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6A316","fl":"上课","grrlID":0,"jssj":"20:55","kssj":"19:20","nq":"2019-06-12","nr":"人工智能导论","sfSjtz":"","skjc":"","sm":""},{"dd":"六教6B109","fl":"上课","grrlID":0,"jssj":"12:15","kssj":"09:50","nq":"2019-06-13","nr":"城市能源系统","sfSjtz":"","skjc":"","sm":""}]'''
jp = json.loads(strin)



content = ''
i = 0
cal = icalendar.Calendar()
cal.add('prodid', '-//My calendar product//mxm.dk//')
cal.add('version', '2.0')
for item in jp:
    start = item['nq']+' '+item['kssj']
    start = datetime.datetime.strptime(start, "%Y-%m-%d %H:%M")
    end = item['nq'] +' '+item['jssj']a
    end = datetime.datetime.strptime(end, "%Y-%m-%d %H:%M")
    dis = 'Class:'+item['nr']+'\n'+'Loc:'+item['dd']+'\n'+'Start:'+item['kssj']+'\t'+'End:'+item['jssj']+'\n'+item['nq']+'\n'
    
    event = icalendar.Event()
    event.add('summary', item['nr'])
    event.add('dtstart', start)
    event.add('dtend', end)
    event['location'] = icalendar.vText(item['dd'])
    event.add('description',dis)
    cal.add_component(event)
    
# 校历
firstDay = datetime.datetime(2019, 2, 25)

for i in range(0,18):
    start = firstDay + datetime.timedelta(days = 7)*i
    k = i+1
    smr = '校历第%d周'%k
    event = icalendar.Event()
    event.add('summary', smr)
    event.add('dtstart', start)
    event.add('dtend', start+datetime.timedelta(days = 1))
    cal.add_component(event)
    


file = open("Cal.ics","wb")
file.write(cal.to_ical())
file.close
